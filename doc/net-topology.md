实现机房网络拓扑管理
功能：

1. 2D 图实现，用标准拓扑图标代表拓扑节点设备
2. 物理线缆连接、端口对应关系（端口信息由后端从 Prometheus 通过 ident 标签查询提供）
3. 拓扑与 cmdb 资产挂钩绑定（资产设备必须是已正常监控状态的设备）
4. 态势感知

说明：

- 端口信息：由后端从 Prometheus 通过 ident 标签查询提供，前端仅展示端口编号、名称、状态，不需要端口速率和端口类型
- 资产关联：拓扑节点只能关联已正常监控状态的 CMDB 资产设备，后端提供的资产列表已经是已监控的，前端无需验证
- 连接关系：拓扑之间用连接的线段代表物理连接，不需要详细的线缆管理

一、核心功能设计（最终版）

1. 拓扑节点设备管理
   设备节点创建
   从后端提供的已监控资产列表中选择设备
   后端接口只返回已正常监控状态的资产设备
   支持按资产模型筛选（服务器/交换机/路由器/防火墙等）
   支持按机房、机柜筛选资产
   设备节点展示
   使用标准拓扑图标代表不同类型的设备
   设备卡片显示关键信息：设备名称、IP、运行状态、所属机房/机柜
   设备状态颜色区分（绿色正常/红色故障/黄色告警）
   设备节点编辑
   支持拖拽调整设备位置
   支持设备属性编辑（名称、标签等）
   支持设备删除（需检查连接关系）
2. 端口信息展示（简化版）
   端口信息获取
   端口信息由后端从 Prometheus 通过 ident 标签查询提供
   前端仅展示端口信息，不进行端口管理
   端口信息展示（仅展示必要信息）
   端口编号
   端口名称
   端口状态（up/down/unknown）- 从监控数据获取
   不展示：端口速率、端口类型
   端口与连接的关联
   连接关系需要指定源端口和目标端口
   端口信息用于连接关系的建立和展示
3. 网络连接关系管理（线段表示）
   连接关系创建
   通过拖拽或点击方式创建连接
   选择源设备的端口和目标设备的端口
   连接用线段在拓扑图中展示
   支持连接标签显示（端口信息）
   连接关系展示
   连接线段颜色区分状态（绿色正常/红色故障/黄色告警）
   连接线段支持标签显示（源端口->目标端口）
   连接线段支持悬停显示详细信息
   连接关系管理
   支持编辑连接关系（修改源端口/目标端口）
   支持删除连接关系
   支持连接关系验证（检测冲突、环路等）
4. 拓扑与 CMDB 资产关联（无需验证）
   资产设备筛选
   后端接口只返回已正常监控状态的资产设备
   前端无需验证监控状态，直接使用后端提供的资产列表
   支持按资产模型、机房、机柜筛选
   资产信息展示
   拓扑节点显示关联的资产信息
   支持查看完整的资产详情
   资产信息变更时自动更新拓扑视图
   资产关联流程
   用户选择要添加的设备类型或筛选条件
   调用后端接口获取已监控资产设备列表（后端已过滤）
   用户选择设备，创建拓扑节点
   拓扑节点自动关联 CMDB 资产 ID
5. 2D 拓扑图实现
   拓扑画布
   2D 画布支持缩放、平移
   支持网格背景、标尺
   支持画布背景设置
   设备节点渲染
   使用标准拓扑图标（根据设备类型）
   设备节点支持拖拽移动
   设备节点支持选中、编辑、删除
   连接线段渲染
   连接线段自动计算路径（避免重叠）
   连接线段支持箭头指向
   连接线段支持标签显示
   拓扑布局
   支持自动布局算法（力导向、层次布局等）
   支持手动拖拽调整布局
   支持布局保存和恢复
   二、与资产和机房管理的集成功能
6. 资产设备筛选和关联（简化）
   设备筛选条件
   资产模型筛选（服务器/交换机/路由器/防火墙等）
   机房筛选（只显示指定机房的设备）
   机柜筛选（只显示指定机柜的设备）
   后端自动过滤：只返回已监控的设备
   设备关联流程
   用户选择要添加的设备类型或筛选条件
   调用后端接口获取已监控资产设备列表（后端已过滤，无需前端验证）
   用户选择设备，创建拓扑节点
   拓扑节点自动关联 CMDB 资产 ID
   资产信息同步
   资产信息变更时自动更新拓扑节点
   资产删除时提示用户处理拓扑节点
   资产监控状态变更时更新拓扑节点状态
7. 机房位置关联
   设备位置信息展示
   在拓扑节点中显示设备所属机房和机柜
   支持按机房筛选拓扑视图
   支持按机柜筛选拓扑视图
   机房布局与拓扑的联动
   在机房可视化布局中可查看网络拓扑
   支持从机房布局跳转到网络拓扑视图
   支持从拓扑视图查看设备在机房中的位置
   跨机房连接可视化
   展示跨机房的网络连接
   连接线段显示跨机房标识
   三、态势感知功能
8. 网络状态监控（基于 Prometheus 数据）
   实时状态展示
   设备在线/离线状态（从 Prometheus 查询）
   端口状态（up/down）- 从 Prometheus 通过 ident 标签查询
   连接状态（根据端口状态计算）
   设备性能指标（CPU、内存、带宽等）
   状态颜色编码
   设备状态用颜色区分（绿色正常/红色故障/黄色告警）
   连接线段状态用颜色区分
   端口状态用颜色区分
   状态刷新机制
   支持自动刷新（定时从后端获取最新状态）
   支持手动刷新
   后端通过 Prometheus 查询实时状态
9. 网络性能监控
   性能指标展示
   设备性能指标（CPU、内存使用率）
   端口带宽使用率（从 Prometheus 查询）
   网络流量统计
   性能可视化
   在拓扑节点上显示性能指标
   支持查看性能趋势图表
   性能告警阈值设置
10. 网络告警管理
    告警展示
    在拓扑图中显示告警设备（告警图标）
    告警设备高亮显示
    告警详情查看
    告警统计
    告警数量统计
    告警级别分布
    告警趋势分析
11. 网络健康度评估
    健康度指标
    设备在线率
    端口可用率
    连接可用率
    性能指标健康度
    健康度可视化
    健康度评分展示
    健康度趋势图表
    四、高级功能
12. 拓扑视图管理
    多层级拓扑视图
    机房级拓扑：展示机房内所有网络设备的连接关系
    机柜级拓扑：展示单个机柜内设备的连接关系
    跨机房拓扑：展示多个机房之间的网络连接
    业务网络拓扑：按业务分组展示网络拓扑
    拓扑视图切换
    支持在不同视图间切换
    支持视图保存和加载
    支持自定义视图
13. 网络路径分析
    路径查找
    查找两个设备之间的网络路径
    显示路径经过的所有设备和端口
    路径可视化
    在拓扑图中高亮显示路径
    显示路径的详细信息
14. 网络拓扑搜索和定位
    设备搜索
    按设备名称、IP 地址搜索
    按资产编号搜索
    搜索结果在拓扑图中定位并高亮
    连接搜索
    搜索特定端口的所有连接
    搜索特定设备的连接关系
15. 网络拓扑导出和打印
    拓扑图导出
    导出为图片（PNG/SVG）
    导出为 PDF
    导出拓扑数据（JSON 格式）
    五、数据模型设计建议
16. 核心数据模型
    拓扑节点表（TopologyNode）
    节点 ID、节点名称
    关联 CMDB 资产 ID（必填，后端已确保资产已监控）
    设备类型、设备图标
    节点位置信息（X、Y 坐标）
    所属拓扑视图 ID
    连接关系表（TopologyConnection）
    连接 ID
    源节点 ID、源端口（端口编号，从后端获取）
    目标节点 ID、目标端口（端口编号，从后端获取）
    连接类型、连接状态
    连接标签
    拓扑视图表（TopologyView）
    视图 ID、视图名称
    视图类型（机房级/机柜级/跨机房/业务网络）
    视图配置（布局、缩放等）
    关联的机房 ID、机柜 ID 等
    六、后端 API 接口需求
17. 端口信息查询接口
    GET /api/topology/devices/:assetId/ports
    说明：通过资产 ID 查询设备的端口信息
    数据来源：从 Prometheus 通过 ident 标签查询
    返回：端口列表

- 端口编号
- 端口名称
- 端口状态（up/down/unknown）
- 不返回：端口速率、端口类型
  GET /api/topology/devices/:assetId/ports 说明：通过资产 ID 查询设备的端口信息数据来源：从 Prometheus 通过 ident 标签查询返回：端口列表 - 端口编号 - 端口名称 - 端口状态（up/down/unknown） - 不返回：端口速率、端口类型

18. 已监控资产设备查询接口
    GET /api/topology/assets/monitored
    说明：查询已正常监控状态的资产设备列表（后端已过滤，只返回已监控的设备）
    筛选条件：

- 资产模型 ID（gids）
- 机房 ID（roomId）
- 机柜 ID（rackId）
  返回：已监控的资产设备列表（后端已确保所有返回的设备都是已监控状态）
  GET /api/topology/assets/monitored 说明：查询已正常监控状态的资产设备列表（后端已过滤，只返回已监控的设备）筛选条件： - 资产模型 ID（gids） - 机房 ID（roomId） - 机柜 ID（rackId）返回：已监控的资产设备列表（后端已确保所有返回的设备都是已监控状态）
  七、实现优先级建议
  高优先级（核心功能）
  拓扑节点设备管理（关联已监控资产，无需验证）
  端口信息展示（仅展示端口编号、名称、状态）
  网络连接关系管理（线段表示）
  2D 拓扑图实现
  网络状态监控（基于 Prometheus）
  中优先级（增强功能）
  拓扑与 CMDB 资产关联
  多层级拓扑视图
  网络性能监控
  网络告警管理
  拓扑搜索和定位
  低优先级（高级功能）
  网络路径分析
  拓扑导出和打印
  网络健康度评估
  拓扑历史记录
  八、关键设计要点总结
  端口信息：由后端从 Prometheus 通过 ident 标签查询提供，前端仅展示端口编号、名称、状态，不展示端口速率和端口类型
  资产关联：后端提供的资产列表已经是已监控的，前端无需验证监控状态，直接使用后端返回的资产列表
  连接关系：用线段表示物理连接，不需要详细的线缆管理信息
  状态监控：设备状态、端口状态等从 Prometheus 实时查询，通过后端 API 提供
  资产筛选：支持按资产模型、机房、机柜筛选，后端自动过滤只返回已监控的设备
  以上设计已根据您的澄清调整，去除了端口速率和端口类型的展示，以及资产管理验证功能。
